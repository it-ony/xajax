<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8"/>
    <script type="text/javascript">!function(a,b){function c(a,b,c){var d={error:b,data:c,messageId:a};i.postMessage(JSON.stringify(d),"*")}function d(a){if(!a)return"";var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")}function e(a){var b=Array.prototype.slice.call(arguments);if(b.length>1)for(var c=1;c<b.length;c++){var d=b[c];for(var e in d)d.hasOwnProperty(e)&&(a[e]=d[e])}return a}function f(){var a,b,c;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;for(b=0;3>b;b++){c=k[b];try{a=new ActiveXObject(c)}catch(d){}if(a){k=[c];break}}if(!a)throw new Error("XMLHttpRequest not available");return a}function g(a,c,g){var h={url:a};if(e(h,{type:"GET",contentType:"application/x-www-form-urlencoded",async:!0,headers:{},data:null,queryParameter:null},c),h.data&&!("[object String]"===Object.prototype.toString.call(h.data)||"undefined"!=typeof FormData&&h.data instanceof FormData))throw"data must be a string";if(h.hasContent=!/^(?:GET|HEAD)$/.test(h.type),h.queryParameter){var i=d(h.queryParameter);i&&(h.url+=(/\?/.test(h.url)?"&":"?")+i)}var j=f();j.open(h.type,h.url,h.async),h.hasContent&&h.contentType!==!1&&j.setRequestHeader("Content-Type",h.contentType);try{for(var k in h.headers)h.headers.hasOwnProperty(k)&&j.setRequestHeader(k,h.headers[k])}catch(l){}j.send(h.data);var m=function(a,c){var d,e=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm;if(m&&(c||4===j.readyState)){if(m=b,c)4!==j.readyState&&j.abort();else{for(var f,h={},i=j.getAllResponseHeaders();f=e.exec(i);)h[f[1]]=f[2];d={status:j.status,statusText:j.statusText,response:j.responseText,headers:h}}g&&g(c,d)}};return h.async&&4!==j.readyState?j.onreadystatechange=m:m(),j}var h=a.XAJAX=a.XAJAX||{},i=a.parent,j=a.console,k=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],l=function(b){function d(a){if(f){var d=JSON.parse(a.data);if(!(d&&d.hasOwnProperty("type")&&d.hasOwnProperty("data")&&d.hasOwnProperty("messageId")))return c(d.messageId,"Data couldn't be parsed",null),void 0;if(!b.allowOrigin(a.origin))return c(d.messageId,"Origin "+a.origin+" not allowed",null),void 0;var e=h[d.type];if(e)try{e(d.data,d.messageId)}catch(g){c(d.messageId,g,null)}else c(d.messageId,"Handler for type '"+d.type+"' not found",null)}}b=e({},{allowedOrigins:[],allowedRequests:[],allowOrigin:function(a){for(var b=0;b<this.allowedOrigins.length;b++){var c=this.allowedOrigins[b];if("*"===c)return!0;if(c===a)return!0}return!1},allowRequest:function(a){for(var b=0;b<this.allowedRequests.length;b++){var c=this.allowedRequests[b];if("[object RegExp]"===Object.prototype.toString.call(c)){if(c.test(a))return!0}else if(c===a)return!0}return!1}},b);var f=!1,h={ajax:function(a,d){b.allowRequest(a.url)?g(a.url,a.options,function(a,b){c(d,a,b)}):c(d,"Request for url '"+a.url+"' not allowed",null)}};a.addEventListener?addEventListener("message",d,!1):attachEvent("onmessage",d),i?(i.postMessage("initialized","*"),f=!0):j&&j.log&&j.log("Cannot find parent")};h.createServer=function(a){return new l(a)}}(window);</script>
</head>
<body>

<script type="text/javascript">

    XAJAX.createServer({
        allowedOrigins: [
            // use "*" for allow all origins
        ],

        allowedRequests: [
            /*
            *  a RegExp or String that guard the access for ajax requests e.g.
            *  /^\/api/ - to allow all /api* calls
            * */
        ]

        /*
        ,allowOrigin: function(origin) {
            // return true if origin is allowed
        }

        ,allowRequest: function (url) {
            // return true if
        }
        */
    });

</script>

</body>
</html>